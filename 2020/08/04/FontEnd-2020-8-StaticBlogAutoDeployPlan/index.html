<!DOCTYPE html>

<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->


<!-- comment -->






    <link rel="dns-prefetch" href="//cdn1.lncld.net">


<!-- analytics -->







    <!-- ## Preload ## -->
    




    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>依托于GithubPages的Vuepress静态博客GithubAction自动部署方案 | QiJieH の Link</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/blog/img/favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/blog/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/blog/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/blog/css/highlight/atelier-heath-light.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/blog/css/highlight/atelier-heath-light.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="QiJieH の Link"><meta name="msapplication-starturl" content="http://qijieh.gitee.io/blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="QiJieH の Link"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="依托于GithubPages的Vuepress静态博客GithubAction自动部署方案 | QiJieH の Link"><meta property="og:site_name" content="QiJieH の Link"><meta property="og:type" content="article"><meta property="og:url" content="http://qijieh.gitee.io/blog/2020/08/04/FontEnd-2020-8-StaticBlogAutoDeployPlan/"><meta property="og:locale" content="zh-CN"><meta name="description" content="博客发表流程：  项目文件下新建 Markdown 文章  git push   借助 GithubAction 实现 Github &amp;amp; Gitee 双端自动部署。 - QiJieH - QiJieH の Link"><meta name="keywords" content="Git, Github, Github Pages, Github Action, Vuepress, Gitee"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200804232214.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805193936.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805210322.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806160224.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806164348.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806174117.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806175611.png"><meta property="og:image" content="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806185536.png"><meta property="article:published_time" content="2020-08-03T16:00:00.000Z"><meta property="article:modified_time" content="2020-11-25T09:26:27.960Z"><meta property="og:updated_time" content="2020-11-25T09:26:27.960Z"><meta property="article:author" content="QiJieH"><meta property="article:tag" content="Git, Github, Github Pages, Github Action, Vuepress, Gitee"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="http://qijieh.gitee.io/blog/2020/08/04/FontEnd-2020-8-StaticBlogAutoDeployPlan/">

    <meta name="generator" content="Hexo 5.2.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "http://qijieh.gitee.io/blog/2020/08/04/FontEnd-2020-8-StaticBlogAutoDeployPlan/",
    "@type": "BlogPosting",
    "logo": "http://qijieh.gitee.io/blog/img/favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://qijieh.gitee.io/blog/2020/08/04/FontEnd-2020-8-StaticBlogAutoDeployPlan/"
    },
    "headline": "依托于GithubPages的Vuepress静态博客GithubAction自动部署方案 | QiJieH の Link",
    
    "image": {
        "@type": "ImageObject",
        "url": "http://qijieh.gitee.io/blog/img/favicon.ico"
    },
    
    "datePublished": "2020-08-03T16:00:00.000Z",
    "dateModified": "2020-11-25T09:26:27.960Z",
    "author": {
        "@type": "Person",
        "name": "QiJieH",
        "image": {
            "@type": "ImageObject",
            "url": "http://qijieh.gitee.io/blog/img/avatar.png"
        },
        "description": "Talk is cheap, show me the code."
    },
    "publisher": {
        "@type": "Organization",
        "name": "QiJieH の Link",
        "logo": {
            "@type": "ImageObject",
            "url": "http://qijieh.gitee.io/blog/img/favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "http://qijieh.gitee.io/blog/blog/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "Git, Github, Github Pages, Github Action, Vuepress, Gitee",
    "description": "博客发表流程：  项目文件下新建 Markdown 文章  git push   借助 GithubAction 实现 Github &amp;amp;amp; Gitee 双端自动部署。 - QiJieH - QiJieH の Link"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/blog/">QiJieH の Link</a></h1>

    <p class="text-center header-slogan">
        
            
                Talk is cheap, show me the code.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/blog/" class="navbar-link">首页</a>
    
    
        <a href="/blog/archives/" class="navbar-link">归档</a>
    
    
        <a href="/blog/search" class="navbar-link">搜索</a>
    
    
        <a href="/blog/tags" class="navbar-link">标签</a>
    
        <a href="/blog/links" class="navbar-link">友链</a>
    
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">依托于GithubPages的Vuepress静态博客GithubAction自动部署方案</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/blog/img/avatar.png" src="/blog/img/suka-lazyload.gif" alt="QiJieH's Avatar">
        <span>2020-08-04</span>
        
            <span class="suka-devide-dot"></span>
            <a class="category-link" href="/blog/categories/FrontEnd/">FrontEnd</a>
        
        
        
            <span class="suka-devide-dot"></span>
<span id="/blog/2020/08/04/FontEnd-2020-8-StaticBlogAutoDeployPlan/" class="leancloud-visitors" data-flag-title="依托于GithubPages的Vuepress静态博客GithubAction自动部署方案">
    <span>view </span>
    <span class="leancloud-visitors-count">0</span>
    <span></span>
</span>
        
    </p>
    <div class="post-header-info-right">
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BC%80%E5%A7%8B%E4%B9%8B%E5%89%8D"><span class="post-toc-number">1.</span> <span class="post-toc-text">开始之前</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="post-toc-number">2.</span> <span class="post-toc-text">快速开始</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE"><span class="post-toc-number">3.</span> <span class="post-toc-text">修改配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%A6%96%E9%A1%B5%E9%85%8D%E7%BD%AE"><span class="post-toc-number">4.</span> <span class="post-toc-text">首页配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%87%AA%E5%AE%9A%E6%A0%B7%E5%BC%8F"><span class="post-toc-number">5.</span> <span class="post-toc-text">自定样式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%A2%98%E9%A2%9C%E8%89%B2"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">修改主题颜色</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%A2%98%E6%A0%B7%E5%BC%8F"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">修改主题样式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BC%95%E7%94%A8%E8%84%9A%E6%9C%AC%E4%B8%8E%E6%A0%B7%E5%BC%8F"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">引用脚本与样式</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0"><span class="post-toc-number">6.</span> <span class="post-toc-text">添加文章</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="post-toc-number">7.</span> <span class="post-toc-text">插件配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF"><span class="post-toc-number">8.</span> <span class="post-toc-text">部署上线</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%8C%E7%AB%AF%E9%83%A8%E7%BD%B2"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">双端部署</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%89%8B%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">手动部署</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="post-toc-number">8.3.</span> <span class="post-toc-text">自动部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%88%9D%E8%AF%86GithubAction"><span class="post-toc-number">8.3.1.</span> <span class="post-toc-text">初识GithubAction</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Automate-your-workflow-from-idea-to-production"><span class="post-toc-number"></span> <span class="post-toc-text">Automate your workflow from idea to production</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%BC%96%E5%86%99workflows%E6%96%87%E4%BB%B6"><span class="post-toc-number">0.0.1.</span> <span class="post-toc-text">编写workflows文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AD%97%E6%AE%B5%E8%AF%B4%E6%98%8E"><span class="post-toc-number">0.0.2.</span> <span class="post-toc-text">基本字段说明</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86"><span class="post-toc-number">0.0.3.</span> <span class="post-toc-text">工作流程梳理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#workflow%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE"><span class="post-toc-number">0.0.4.</span> <span class="post-toc-text">workflow敏感数据</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Deploy"><span class="post-toc-number">0.0.4.1.</span> <span class="post-toc-text">Deploy</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Sync-to-Gitee"><span class="post-toc-number">0.0.4.2.</span> <span class="post-toc-text">Sync to Gitee</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Build-Gitee-Pages"><span class="post-toc-number">0.0.4.3.</span> <span class="post-toc-text">Build Gitee Pages</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Vssue%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6"><span class="post-toc-number">0.0.5.</span> <span class="post-toc-text">Vssue评论插件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%BC%80%E5%A7%8B%E6%8E%A8%E9%80%81"><span class="post-toc-number">0.0.6.</span> <span class="post-toc-text">开始推送</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%AE%BF%E9%97%AE%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2"><span class="post-toc-number">0.0.7.</span> <span class="post-toc-text">访问你的博客</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9B%BE%E5%BA%8A%E6%90%AD%E5%BB%BA"><span class="post-toc-number">1.</span> <span class="post-toc-text">图床搭建</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SEO%E4%BC%98%E5%8C%96"><span class="post-toc-number">2.</span> <span class="post-toc-text">SEO优化</span></a></li></ol></div>
                        
                    
                    <article id="post-content">
                        <p>博客发表流程：</p>
<ol>
<li><p>项目文件下新建 Markdown 文章</p>
</li>
<li><p><code>git push</code></p>
</li>
</ol>
<p>借助 GithubAction 实现 Github &amp; Gitee 双端自动部署。</p>
<a id="more"></a>

<h2 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h2><blockquote>
<p>这是我的第一个博客网站，前后花费了差不多一个星期，期间参考了大量博文，文档。</p>
<p>总结建站前后的经验写下第一篇关于本博客的部署教程的博文，希望能够帮助和我一样摸索建站的人。</p>
<p>​                                                                                                                                                                    于朝阳升起处，我将踏上旅程</p>
</blockquote>
<p><strong>项目描述</strong></p>
<ul>
<li><p>一个基于 Vuepress 第三方主题 vuepress-theme-reco 搭建的静态博客</p>
</li>
<li><p>托管项目代码在 Github 仓库，并使用 Github Pages 服务运行网站。</p>
</li>
<li><p>使用 Github Action 实现自动编译部署。</p>
</li>
<li><p>使用 Github Action 实现同步推送仓库代码至 Gitee 和更新 Gitee Pages 服务。</p>
</li>
</ul>
<blockquote>
<p>Github My Blog : <a target="_blank" rel="noopener" href="https://qijieh.github.io/blog">https://qijieh.github.io/blog</a></p>
<p>Gitee My Blog : <a href="https://qijieh.gitee.io/blog">https://qijieh.gitee.io/blog</a></p>
</blockquote>
<p><strong>项目优越</strong></p>
<ul>
<li>纯静态页面，无需后台数据库。</li>
<li>Github Pages 服务，无需单独服务器。</li>
<li>Git 更新，管理网站。</li>
<li>Github Action 自动部署，专注写作。</li>
<li>Gitee 同步推送，自动更新 Gitee Pages , 更好的国内访问体验</li>
</ul>
<p><strong>项目技术</strong></p>
<p>本项目使用 Vuepress 第三方主题 vuepress-theme-reco 构建，在开始之前你应该对 Vuepress 有一个基本了解，并对其构建流程有一定的初步掌握。</p>
<p>强烈建议按照官方文档在个人电脑上构建一个官方的 Vuepress 项目，以便更好的开始使用接下来的 Vuepress 第三方博客主题。</p>
<p>除此之外，你还需要掌握基本的 Git 使用方法以及对 Github 仓库各项配置的理解和使用，包括 Github Action 的初步认知。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.vuepress.cn/">Vuepress 中文文档</a></p>
<p><a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/">vuepress-theme-reco 官方文档</a></p>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">阮一峰 GitHub Actions 入门教程</a></p>
</blockquote>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><p><strong>npx</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx @vuepress-reco/theme-cli init</span><br></pre></td></tr></table></figure>

<p><strong>npm</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">npm install @vuepress-reco/theme-cli -g</span><br><span class="line">theme-cli init</span><br></pre></td></tr></table></figure>

<p><strong>yarn</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">yarn global add @vuepress-reco/theme-cli</span><br><span class="line">theme-cli init</span><br></pre></td></tr></table></figure>





<p>一切就绪后按照提示，进入项目目录，并安装依赖 (本文之后都将使用 npm 进行管理)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入项目目录</span></span><br><span class="line"><span class="built_in">cd</span> my<span class="literal">-blog</span></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>





<p>通过命令行键入以下命令，并访问监听端口即可查看网站</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200804232214.png"></p>
<h2 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h2><p>网站的各项信息配置存储在了 <code>.vuepress/config.js</code></p>
<p>通过修改 <code>config.js</code> 文件，你可以修改替换网站的大部分预设内容，如 网站标题，logo图标，导航栏Tab选项卡等等。</p>
<p><code>.vuepress/config.js</code> 可以分为以下几个部分</p>
<ul>
<li>基本配置 <code>title</code> <code>description</code> 等等</li>
<li>主题配置 <code>theme</code> <code>themeConfig</code></li>
<li>插件配置 <code>plugins</code></li>
<li>Markdown 配置 <code>markdown</code></li>
</ul>
<p>其中的各项属性说明和配置方法你均可在 <a target="_blank" rel="noopener" href="https://www.vuepress.cn/config/">Vuepress 配置</a> ，<a target="_blank" rel="noopener" href="https://www.vuepress.cn/theme/default-theme-config.html">Vuepress 默认主题配置</a> 和 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/1.x/configJs.html">reco Config.js</a> 中查询得到。</p>
<p>请自行参考文档说明替换相应属性值。</p>
<blockquote>
<p>网站的静态资源存储在了 <code>.vuepress/public</code> 目录下，其设定了全局的相对路径，你只需要以 <code>/</code> 开头对其进行直接引用。</p>
<p>比如替换网站的 logo 图片为 <code>.vuepress/public/web-img/logo.png</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  themeConfig: &#123;</span><br><span class="line">    logo: <span class="string">&#x27;web-img/logo.png&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>关于主题的夜间模式配置请单独参考：</p>
<p><a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/1.x/mode.html">暗色模式适配</a></p>
<p>404 腾讯公益关闭方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  theme: <span class="string">&#x27;reco&#x27;</span>,</span><br><span class="line">  themeConfig: &#123;</span><br><span class="line">    noFoundPageByTencent: <span class="literal">false</span></span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<hr>
<p>这里需要额外注意 base 和 dest 属性：</p>
<p><strong>base</strong></p>
<ul>
<li>类型: <code>string</code></li>
<li>默认值: <code>/</code></li>
</ul>
<p>部署站点的基础路径，如果你想让你的网站部署到一个子路径下，你将需要设置它。如 GitHub pages，如果你想将你的网站部署到 <code>https://foo.github.io/bar/</code>，那么 <code>base</code> 应该被设置成 <code>&quot;/bar/&quot;</code>，它的值应当总是以斜杠开始，并以斜杠结束。</p>
<p><code>base</code> 将会作为前缀自动地插入到所有以 <code>/</code> 开始的其他选项的链接中，所以你只需要指定一次。</p>
<p><strong>dest</strong></p>
<ul>
<li>类型: <code>string</code></li>
<li>默认值: <code>.vuepress/dist</code></li>
</ul>
<p>指定 <code>vuepress build</code> 的输出目录。如果传入的是相对路径，则会基于 <code>process.cwd()</code> 进行解析。</p>
<p>此处先做提醒可不做添加或修改，在 部署上线 步骤中再做详细讲解。</p>
<hr>
<p>运行命令，查看修改</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805152255.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805152255.png</a> =700x)</p>
<h2 id="首页配置"><a href="#首页配置" class="headerlink" title="首页配置"></a>首页配置</h2><p>更换博客首页的 Banner 或 slogan 是单独在项目根目录下的 <code>README.md</code> 文件进行的。</p>
<p>由于 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/1.x/home.html">reco 首页配置</a> 已经详细介绍，这里不再进行赘述。</p>
<blockquote>
<p>reco 提供了三种首页样式，在 npx reco主题时，提供了选择支。</p>
<ul>
<li>blog式</li>
<li>文档式</li>
<li>午后南杂</li>
</ul>
<p>如果你需要从文档式切换至blog式，只需修改 <code>.vuepress/config.js</code> 主题配置的 <code>type</code> 属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  theme: <span class="string">&#x27;reco&#x27;</span>,</span><br><span class="line">  themeConfig: &#123;</span><br><span class="line">    type: <span class="string">&#x27;blog&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>修改完成后，运行命令，查看修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805155833.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805155833.png</a> =700x)</p>
<h2 id="自定样式"><a href="#自定样式" class="headerlink" title="自定样式"></a>自定样式</h2><p>如果你不满足于主题提供的默认样式，VuePress 提供了一些简单的接口文件，可以让你能够很方便地定制你自己想要的效果。</p>
<h3 id="修改主题颜色"><a href="#修改主题颜色" class="headerlink" title="修改主题颜色"></a>修改主题颜色</h3><p>你可以通过配置 <code>.vuepress/styles/palette.styl</code> （手动创建）来快速修改主题的一些颜色属性。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认值</span></span><br><span class="line"><span class="variable">$accentColor</span> = <span class="number">#3eaf7c</span>                      <span class="comment">// 主题颜色</span></span><br><span class="line"><span class="variable">$textColor</span> = <span class="number">#2c3e50</span>                        <span class="comment">// 文本颜色</span></span><br><span class="line"><span class="variable">$borderColor</span> = <span class="number">#eaecef</span>                      <span class="comment">// 边框线颜色</span></span><br><span class="line"><span class="variable">$codeBgColor</span> = <span class="number">#282c34</span>                      <span class="comment">// 代码块背景色</span></span><br><span class="line"><span class="variable">$backgroundColor</span> = <span class="number">#ffffff</span>                  <span class="comment">// 悬浮块背景色</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>色彩网站：<a target="_blank" rel="noopener" href="https://nipponcolors.com/">日式传统色</a></p>
<p>测试配色可读性：<a target="_blank" rel="noopener" href="https://color.review/">Color.review</a></p>
</blockquote>
<h3 id="修改主题样式"><a href="#修改主题样式" class="headerlink" title="修改主题样式"></a>修改主题样式</h3><p>你可以创建一个 <code>.vuepress/styles/index.styl</code>文件以方便地添加额外样式。这是一个 Stylus 文件，但你也可以使用正常的 CSS 语法。</p>
<p>在网站任何可以访问的页面都可以通过 <code>index.styl</code> 文件书写 CSS 样式，通过<strong>浏览器开发者工具</strong>我们能够十分轻松的选择元素并添加或修改样式。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** .vuepress/styles/index.styl **/</span></span><br><span class="line"></span><br><span class="line">// 修改网页背景色，增强可读性</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2f2f2</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 修改导航栏搜索框圆弧化</span><br><span class="line"><span class="selector-class">.search-box</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">1.25rem</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 博文 <span class="selector-tag">box</span> 背景</span><br><span class="line"><span class="selector-class">.page-title</span>,</span><br><span class="line"><span class="selector-class">.theme-reco-content</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">0.25rem</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--box-shadow);</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="built_in">var</span>(--border-color);</span><br><span class="line">&#125;</span><br><span class="line">// 分离博文标题与内容</span><br><span class="line"><span class="selector-class">.page-title</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">32px</span><span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<blockquote>
<p>如果你对样式修改没有头绪可以参考其他使用 reco主题的博客样式并自行修改</p>
<p><a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/other/theme-example.html">reco 优秀博客案例</a></p>
<p>如果你需要本博客的自定义样式，可以访问博客仓库</p>
<p><a target="_blank" rel="noopener" href="https://github.com/QiJieH/blog">qijieh/blog</a></p>
</blockquote>
<p>运行 <code>npm run dev</code> 查看我们修改的样式</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805160856.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805160856.png</a> =700x)</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805161235.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805161235.png</a> =700x)</p>
<h3 id="引用脚本与样式"><a href="#引用脚本与样式" class="headerlink" title="引用脚本与样式"></a>引用脚本与样式</h3><p>你可以通过配置 <code>.vuepress/config.js</code> 中的 <code>head</code> 来引入自己的js脚本与样式。</p>
<p>通过外挂css和js来对主题样式曾铁，例如点击效果，花瓣雨等等特效。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  head: [</span><br><span class="line">    [<span class="string">&quot;link&quot;</span>, &#123; <span class="attr">rel</span>: <span class="string">&quot;stylesheet&quot;</span>, <span class="attr">href</span>: <span class="string">&quot;https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css&quot;</span> &#125;],</span><br><span class="line">    [<span class="string">&quot;script&quot;</span>, &#123; <span class="attr">src</span>: <span class="string">&quot;scripts/demo.js&quot;</span> &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比如上面的配置就会被解析为</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;scripts/demo.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关于 <code>head</code> 的详细配置说明请参考<a target="_blank" rel="noopener" href="https://v1.vuepress.vuejs.org/zh/config/#head">官方文档 head 配置</a></p>
<p><strong>以引入鼠标点击效果为例：</strong></p>
<p>在<code>.vuepress\public\js</code>文件夹下创建<code>MouseClickEffect.js</code>文件，填入以下代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a_idx = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">max, min</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>) + min);</span><br><span class="line">&#125;</span><br><span class="line">jQuery(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">    $(<span class="string">&quot;body&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">&quot;富强&quot;</span>, <span class="string">&quot;民主&quot;</span>, <span class="string">&quot;文明&quot;</span>, <span class="string">&quot;和谐&quot;</span>, <span class="string">&quot;自由&quot;</span>, <span class="string">&quot;平等&quot;</span>, <span class="string">&quot;公正&quot;</span>, <span class="string">&quot;法治&quot;</span>, <span class="string">&quot;爱国&quot;</span>, <span class="string">&quot;敬业&quot;</span>, <span class="string">&quot;诚信&quot;</span>, <span class="string">&quot;友善&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> $i = $(<span class="string">&quot;&lt;span/&gt;&quot;</span>).text(a[a_idx]);</span><br><span class="line">        a_idx = (a_idx + <span class="number">1</span>) % a.length;</span><br><span class="line">        <span class="keyword">var</span> x = e.pageX,</span><br><span class="line">            y = e.pageY;</span><br><span class="line">        $i.css(&#123;</span><br><span class="line">            <span class="string">&quot;z-index&quot;</span>: <span class="number">999999999999999999999999999999999999999999999999999999999999999999999</span>,</span><br><span class="line">            <span class="string">&quot;top&quot;</span>: y - <span class="number">20</span>,</span><br><span class="line">            <span class="string">&quot;left&quot;</span>: x,</span><br><span class="line">            <span class="string">&quot;position&quot;</span>: <span class="string">&quot;absolute&quot;</span>,</span><br><span class="line">            <span class="string">&quot;font-weight&quot;</span>: <span class="string">&quot;bold&quot;</span>,</span><br><span class="line">            <span class="string">&quot;color&quot;</span>: <span class="string">`rgb(<span class="subst">$&#123;getRandom(<span class="number">255</span>,<span class="number">0</span>)&#125;</span>,<span class="subst">$&#123;getRandom(<span class="number">255</span>,<span class="number">0</span>)&#125;</span>,<span class="subst">$&#123;getRandom(<span class="number">255</span>,<span class="number">0</span>)&#125;</span>)`</span>,</span><br><span class="line">            <span class="string">&quot;user-select&quot;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">            <span class="string">&quot;cursor&quot;</span>: <span class="string">&#x27;default&#x27;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        $(<span class="string">&quot;body&quot;</span>).append($i);</span><br><span class="line">        $i.animate(&#123;</span><br><span class="line">                <span class="string">&quot;top&quot;</span>: y - <span class="number">180</span>,</span><br><span class="line">                <span class="string">&quot;opacity&quot;</span>: <span class="number">0</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="number">1500</span>,</span><br><span class="line">            <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $i.remove();</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>然后在主题配置文件<code>config.js</code>下的<code>head</code>引入以上js，这里的jquery必须引入，鼠标点击代码才能生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	head: [</span><br><span class="line">    <span class="comment">// 网页标签栏图标</span></span><br><span class="line">    [<span class="string">&#x27;link&#x27;</span>, &#123; <span class="attr">rel</span>: <span class="string">&#x27;icon&#x27;</span>, <span class="attr">href</span>: <span class="string">&#x27;/vuepress/favicon.ico&#x27;</span> &#125;],</span><br><span class="line">    <span class="comment">// 移动栏优化</span></span><br><span class="line">    [<span class="string">&#x27;meta&#x27;</span>, &#123; <span class="attr">name</span>: <span class="string">&#x27;viewport&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;width=device-width,initial-scale=1,user-scalable=no&#x27;</span> &#125;],</span><br><span class="line">    <span class="comment">// 引入jquery</span></span><br><span class="line">    [<span class="string">&quot;script&quot;</span>, &#123;</span><br><span class="line">      <span class="string">&quot;language&quot;</span>: <span class="string">&quot;javascript&quot;</span>,</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text/javascript&quot;</span>,</span><br><span class="line">      <span class="string">&quot;src&quot;</span>: <span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js&quot;</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="comment">// 引入鼠标点击脚本</span></span><br><span class="line">    [<span class="string">&quot;script&quot;</span>, &#123;</span><br><span class="line">      <span class="string">&quot;language&quot;</span>: <span class="string">&quot;javascript&quot;</span>,</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;text/javascript&quot;</span>,</span><br><span class="line">      <span class="string">&quot;src&quot;</span>: <span class="string">&quot;/js/MouseClickEffect.js&quot;</span></span><br><span class="line">    &#125;]</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>参考博文：<a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/other/reco-optimization.html">vuepress-theme-reco个人向优化</a></p>
</blockquote>
<h2 id="添加文章"><a href="#添加文章" class="headerlink" title="添加文章"></a>添加文章</h2><p>在开始插件配置之前，先向网站添加几篇文章。</p>
<p>通过查看项目目录不难发现博客文章被存储在了 <code>blogs</code>  下，除此之外还有另外一个名为 <code>docs</code> 的目录存储文档文件。如果你的博客网站不需要文档类型的博文，可以删除改 <code>docs</code> 目录并删除 <code>config.js</code> 中的 <code>themeConfig &gt; nav</code> 中的 Docs Tab选项。</p>
<p>在 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/other/question.htm">reco issue</a> 中提到：</p>
<blockquote>
<p>Q：文章的存放位置有规定吗？</p>
<p>A：你可以将你的文章存放在任意位置，但是你需要保证它是 VuePress 可以解析的位置，比如你使用的命令是 <code>vuepress dev docs</code> ，那么请将所有文章存放在 <code>docs/</code> 中，但是主题并不会强制你放在哪个子目录，这个按照你的喜好来即可，详情见 <a target="_blank" rel="noopener" href="https://vuepress.vuejs.org/zh/guide/directory-structure.html">详细的 VuePress 目录结构配置</a>。</p>
</blockquote>
<p>尽管主题对文章存放位置没有硬性要求，但是你的项目结构应该保持整洁，建议沿用默认的存储路径。</p>
<p>比如有当前一篇文章 <code>Vue框架学习记录.md</code> 拥有以下 Front Matter ：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Vue框架学习记录</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2020-08-05</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">FrontEnd</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Vue</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>

<p>那么它的存储路径应该为 <code>blogs/FrontEnd/2020-8/Vue框架学习记录.md</code> 。</p>
<blockquote>
<p>主题不会根据你的文件路径来进行文章分类，而是对 Markdown 文件的 Front Matter 中的相关标签进行分类解析。</p>
<p>但是为了保持项目结构整洁请务必设置路径为分类名称。</p>
<p><a target="_blank" rel="noopener" href="https://vuepress.vuejs.org/zh/guide/frontmatter.htm">Vuepress Front Matter</a> </p>
<p><a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/1.x/frontMatter.html">reco Front Matter 示例</a></p>
</blockquote>
<p>根据具体场景新建md文章，并修改存储路径。删除主题的测试文章，添加一篇自己的测试博文 （建议长度一定，拥有标题结构和代码块，方便后期测试）。</p>
<p>这是一个博文存储结构的示例：</p>
<pre><code>blogs
├── FrontEnd
│   ├── 2020-8
│   │   └── article01.md
│   └── 2020-7
├── Java
│   ├── 2020-8
│   └── 2020-7
└── Python</code></pre>
<blockquote>
<p>向文章添加摘要，显示在博文列表中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是摘要，在 more 标签之前的内容会展示到博文列表上</span><br><span class="line">**支持md语法**</span><br><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/1.x/abstract.html">reco 添加摘要</a></p>
<p>更多 Vuepress Markdown 支持语法请查看：</p>
<p><a target="_blank" rel="noopener" href="https://www.vuepress.cn/guide/markdown.html">Vuepress Markdown扩展</a></p>
<p>存储博文时务必以英文命名，否则可能导致 URL 混乱</p>
</blockquote>
<p><strong>添加完成后，运行命令，查看添加成功与否</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805174613.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805174613.png</a> =700x)</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805174844.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805174844.png</a> =700x)</p>
<h2 id="插件配置"><a href="#插件配置" class="headerlink" title="插件配置"></a>插件配置</h2><p>关于插件的配置语法 <a target="_blank" rel="noopener" href="https://www.vuepress.cn/plugin/">Vuepress 插件</a> 中已经详细说明，请自行参考文档了解其语法和使用方法。</p>
<p>至此一个完整的博客已经配置出来，但是如果你需要其他需求如 背景音乐播放器，live2d看板娘，代码快捷复制， markdown语法扩展等等，可以通过导入第三方插件来完善你的博客。</p>
<p>reco 主题已经内置了一些实用的插件，这些插件已经完全足够博客基本功能。<a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/plugins/">点击查看</a></p>
<p>但是你依旧可以通过访问 <a target="_blank" rel="noopener" href="https://github.com/vuepressjs/awesome-vuepress#plugins">vuepress插件社区</a> 或 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/other/recommend.html">reco主题插件广场</a> 来新添插件。</p>
<blockquote>
<p>你可以通过这种方式来对主题内置插件的配置进行覆盖，甚至禁用一个内置插件</p>
<p>只需将 Options 设置成 <code>false</code> 便可禁用该插件</p>
<p>就像这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="string">&quot;@vuepress-reco/vuepress-plugin-loading-page&quot;</span>, <span class="literal">false</span>],     <span class="comment">// 禁用加载页面</span></span><br><span class="line">    [<span class="string">&quot;@vuepress-reco/vuepress-plugin-back-to-top&quot;</span>,  <span class="comment">// 返回顶部按钮</span></span><br><span class="line">    	visibilityHeight: <span class="number">500</span>	<span class="comment">// 覆盖其默认配置，重新设置为出现高度为 500</span></span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>接下来引入一个音乐播放器插件 <a target="_blank" rel="noopener" href="https://github.com/moefyit/vuepress-plugin-meting">meting</a> 做为示例</strong></p>
<ol>
<li>install 插件</li>
</ol>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuepress<span class="literal">-plugin</span><span class="literal">-meting</span> <span class="literal">-D</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 <code>.vuepress/config.js</code> 文件中引入插件并按照插件文档配置相关属性</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//....</span></span><br><span class="line">    </span><br><span class="line"><span class="string">&quot;plugins&quot;</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;meting&quot;</span>, &#123;</span><br><span class="line">        meting: &#123;</span><br><span class="line">          auto: <span class="string">&quot;https://music.163.com/#/playlist?id=5156784198&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        aplayer: &#123;</span><br><span class="line">          lrcType: <span class="number">0</span> 	<span class="comment">//禁用歌词显示</span></span><br><span class="line">        &#125;,</span><br><span class="line">        mobile: &#123;		<span class="comment">// 移动端设置</span></span><br><span class="line">          cover: <span class="literal">false</span> <span class="comment">// 取消封面覆盖</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>npm run dev</code> 查看效果</li>
</ol>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805180316.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805180316.png</a> =700x)</p>
<blockquote>
<p>对于新增的播放器，你也可以通过 <code>.vuepress/styles/index.styl</code> 来为其修改样式</p>
<p>在浏览器通过<strong>开发者工具</strong>选中播放器，查看元素类名</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.aplayer-body</span> &#123;</span><br><span class="line">    box-shadow: var(--box-shadow) !important; // 为播放器添加阴影</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.vuepress.cn/zh/config/#styling">Vuepress Styling</a></p>
</blockquote>
<p>下面将列出推荐的插件链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/moefyit/vuepress-plugin-meting">meting</a> ：简单易用的播放器插件，支持自动解析网易云单曲/歌单链接</li>
<li><a target="_blank" rel="noopener" href="https://www.vuepress.cn/plugin/official/plugin-pwa.html">@vuepress/pwa</a> ：网页内容更新提醒</li>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/vuepress-plugin-nuggets-style-copy">vuepress-plugin-nuggets-style-copy</a> ：为代码块添加复杂按钮，并在复制成功后弹出提示信息</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ulivz/vuepress-plugin-flowchart">flowechart</a> ：使你的 Markdown 支持 flow 流程图</li>
<li><a target="_blank" rel="noopener" href="https://github.com/tolking/vuepress-plugin-img-lazy">img-lazy</a> ：图片惰性加载</li>
<li><a target="_blank" rel="noopener" href="https://vuepress.github.io/zh/plugins/copyright/">copyright</a> ：控制网站的复制行为</li>
<li><a target="_blank" rel="noopener" href="https://vuepress.github.io/zh/plugins/smooth-scroll">vuepress-plugin-smooth-scroll</a> ：更圆滑的页面滚动</li>
</ul>
<p>插件的安装引入大同小异，请自行参照插件文档进行配置。</p>
<p><strong>由于评论插件 Vssue （ 已集合到 reco 自带插件 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/plugins/comments.html">comments</a> 中）的特殊性（需要配置项目仓库）将放在 部署上线 之后再进行配置</strong></p>
<h2 id="部署上线"><a href="#部署上线" class="headerlink" title="部署上线"></a>部署上线</h2><p>在正式开始部署上线之前，你应该对 vuepress 的构建流程有一个大致了解。</p>
<p>之前我们使用的 <code>npm run dev</code> 模式运行了 vuepress 的开发模式，这个模式下是不会产生我们需要的静态资源的。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    	<span class="attr">&quot;dev&quot;</span>: <span class="string">&quot;vuepress dev .&quot;</span>,</span><br><span class="line">    	<span class="attr">&quot;build&quot;</span>: <span class="string">&quot;vuepress build .&quot;</span></span><br><span class="line">  	&#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>只有运行 <code>npm run build</code> 时才会在指定目录下构建出我们的博客网页</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    	<span class="string">&quot;dest&quot;</span>: <span class="string">&quot;.vuepress/dist&quot;</span>   <span class="comment">// 指定 vuepress build 的输出目录</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>命令行运行 <code>npm run build</code> ，检查在 <code>.vuepress/dist</code> 下是否能构建出资源文件。</p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805193936.png"></p>
<blockquote>
<p>Error: cannot find module ‘../dist/manifest/client.json’</p>
<p>如果在构建过程中出现此项错误，你的系统环境变量中可能设置了 <code>NODE_ENV : development</code> 将其修改为 <code>NODE_ENV ：production</code> 即可。</p>
<p>详情查看 <a target="_blank" rel="noopener" href="https://github.com/vuejs/vuepress/issues/2194">vue.js issue</a></p>
</blockquote>
<h3 id="双端部署"><a href="#双端部署" class="headerlink" title="双端部署"></a>双端部署</h3><p>本博客同时部署到了 Github 和 Gitee 上，你可以尝试访问</p>
<blockquote>
<p>Github My Blog : <a target="_blank" rel="noopener" href="https://qijieh.github.io/blog">https://qijieh.github.io/blog</a></p>
<p>Gitee My Blog : <a href="https://qijieh.gitee.io/blog">https://qijieh.gitee.io/blog</a></p>
</blockquote>
<p><strong>在此之前你应该明白 Github 和 Gitee 的 Pages 服务差异</strong></p>
<blockquote>
<p>Github 允许用户使用个人域名即 <code>https://[userName].github.io</code> ，只需要在创建仓库时将仓库命名为 <code>[userName].github.io</code> 即可</p>
<p>但是 Gitee 却不允许用户使用个人域名，即无论创建仓库命名为何，都只能指向 <code>https://[userName].gitee.io/[repoName]</code> </p>
</blockquote>
<p>这种差异增加了我们博客双端部署的难度，因为 Vuepress 对于部署到非根路径的项目有着相应配置参考 <a target="_blank" rel="noopener" href="https://www.vuepress.cn/guide/assets.html">基础路径</a> ，如果对部署到二级路径的项目没有设置 <code>config.js</code> 文件中的 <code>base</code> 值，将会导致网页资源的错误加载。</p>
<p>综上所述，为了保持项目的一致性我们不得不放弃使用 Github 提供的个人域名，去与 Gitee 保持一致使用二级域名，这也是为什么上方两个博客链接都不是非根路径的原因所在。</p>
<p>::: tip</p>
<p>如果你只需要部署到一个平台，请酌情参考本博文。</p>
<p>:::</p>
<p><strong>新建仓库</strong></p>
<p>登录 Github 新建仓库，仓库命名自定，本博文以 <code>blog</code> 命名仓库。</p>
<blockquote>
<p>如果你需要进行双端部署切勿命名为 <code>[userName].github.io</code> ，详见上方说明。</p>
<p>如果你只想部署在 Github 推荐以 <code>[userName].github.io</code> 命名。</p>
</blockquote>
<blockquote>
<p>其实命名为 <code>blog</code>  会导致博客 Url 混乱，因为reco主题的 router 设置了 /blogs/ 路由，将会导致出现这样的访问链接：</p>
<p><code>https://qijieh.github.io/blog/blogs/FrontEnd/2020-8/article.html</code></p>
<p>建议命名为：<code>space</code> ，<code>personal</code> ，<code>room</code> 等等</p>
</blockquote>
<p>登录 Gitee 新建仓库，建议仓库名与 Github 仓库名一致，方便访问。</p>
<p><strong>部署方式</strong></p>
<p>部署方式分为两种 手动部署 和 自动部署，两种部署方式唯一的区别在于是否需要本地编译 <code>npm run build</code> 出网页源码。</p>
<p>其详细流程如下：</p>
<ul>
<li>手动部署 （易）<ol>
<li>书写博文 或 修改主题</li>
<li>构建网页文件 <code>npm run build</code> </li>
<li><code>git push</code></li>
</ol>
</li>
<li>自动部署 （难）<ol>
<li>书写博文 或 修改主题</li>
<li><code>git push</code> </li>
</ol>
</li>
</ul>
<blockquote>
<p>自动部署会在服务器端进行网页的构建和编译 <code>npm run build</code>，而不是在开发机上，管理员只需要专注于文章写作，构建部署工作全部交由服务器端完成。</p>
<p>尽管自动部署方案在实行时可能会花费大量时间成本，但是仍然建议你使用自动部署方案，感受 Github Action 的强大之处，并且其一旦完成，后期的维护成本将明显降低。</p>
</blockquote>
<p>::: warning</p>
<p>注意！！！只有自动部署方案才能实现 Gitee 的代码同步和 GiteePages 的自动更新，如果你需要将你的博客网站如同本博客一样在双平台自动部署，请参考自动部署方案。</p>
<p>:::</p>
<h3 id="手动部署"><a href="#手动部署" class="headerlink" title="手动部署"></a>手动部署</h3><p>由于 GithubPages 服务的渲染目录只预设了 <code>root</code> 和 <code>docs</code> ，我们得<strong>重新指定 build 的输出目录，将其重新设定为 <code>docs</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    	<span class="string">&quot;dest&quot;</span>: <span class="string">&quot;docs&quot;</span>  <span class="comment">// vuepress 生成目录</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样 <code>npm run build</code> 的文件便会生成在 <code>docs</code> 目录下。</p>
<p><strong>构建并上传</strong></p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 确保在项目根目录</span></span><br><span class="line">npm run build</span><br><span class="line">.....</span><br><span class="line">build success</span><br><span class="line"></span><br><span class="line">git init</span><br><span class="line">.....</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>



<blockquote>
<p>注意新建 <code>.gitignore</code> 文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node_modules&#x2F;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>上传完成之后，我们需要打开 Github 仓库页面，配置项目的 GithubPages 服务。</p>
<p>点击 仓库Setting 下拉找到 GithuPages 在 Source 中设置如下</p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805210322.png"></p>
<p>注意设置为 <code>/docs</code> 目录，而不是默认的 <code>/root</code> ，这样 GithubPages 就会解析我们 <code>/docs</code>  目录下的博客网页了。</p>
<p>现在点击上方的网址访问你的博客吧。</p>
<p><strong>现在你的博客发布流程为：</strong></p>
<ol>
<li>写博客 或 修改主题</li>
<li><code>npm run build</code></li>
<li><code>git push</code></li>
</ol>
<p><strong>Gitee 同步解决方案</strong></p>
<p>::: warning</p>
<p>手动部署方案适合单仓库部署，如果你执意双端部署将会明显提高维护成本。</p>
<p>:::</p>
<ol>
<li>打开创建的 Gitee 仓库  <strong>管理 &gt; 基本设置 &gt; 仓库远程地址</strong> 输入 Github 的仓库地址</li>
</ol>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211042.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211042.png</a> =750x)</p>
<ol start="2">
<li>返回仓库代码页，<strong>点击仓库名旁边的同步按钮完成推送</strong></li>
</ol>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211244.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211244.png</a> =750x)</p>
<ol start="3">
<li>这样 Github 仓库的代码便会同步至该仓库下，接下来只需要开启该仓库的 Gitee Pages 服务 ：<strong>服务 &gt; Gitee Pages</strong></li>
</ol>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211627.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200805211627.png</a> =750x)</p>
<ol start="4">
<li>点击链接访问你的网站吧。</li>
</ol>
<p><strong>为什么不推荐手动部署的双端托管？</strong></p>
<ul>
<li>首先你得知道 Gitee 仓库的同步功能是不支持自动同步的，也就是说，即使你更新了 Github 仓库的代码，Gitee 这边仍然需要你过来手动点击同步按钮来更新同步。</li>
<li>同样糟糕的是 Gitee Pages 服务和 Github Pages 服务不同，使用 GitHub Pages 时，每当项目有更新，GitHub 会自动帮我们重新部署 GitHub Pages。而 Gitee Pages 则不会如此，它仍需要你点击 Pages 服务的更新按钮来刷新内容！或者开通 Gitee Pages Pro 功能。而 Pro 功能的开通，需要满足以下其中一个条件：<ul>
<li>花钱开通 Pro 功能，￥99/年。</li>
<li>Gitee 项目足够优秀，得到 Gitee 官方的推荐，那么 Gitee 就会提示“您的项目为推荐项目，已自动为您开通 Gitee Pages Pro。</li>
</ul>
</li>
</ul>
<p>这样将意为着每次你在 Github 轻松完成了<code>git push</code> ，你仍然需要登录你的 Gitee 仓库点击强制同步按钮拉取代码，再去点击 Pages 服务的刷新按钮更新网页。</p>
<p><strong>手动部署双端托管的博客发布流程：</strong></p>
<ol>
<li>写文章</li>
<li><code>npm run build</code></li>
<li><code>git push</code></li>
<li>登录 Gitee 仓库</li>
<li>点击强制同步按钮</li>
<li>点击 Pages 服务的更新按钮</li>
</ol>
<p>显然这是十分不友好的，但是当你只部署在 Github 平台上时就可以不用管 Gitee 了。</p>
<h3 id="自动部署"><a href="#自动部署" class="headerlink" title="自动部署"></a>自动部署</h3><p>如果你阅读了上方手动部署的解决方案，可以深感其的不便性，特别是进行 Github 和 Gitee 双平台托管的场景时。</p>
<p>接下来的部署方案，将让你从繁杂的提交流程中抽离出来，让你更加专注博客内容，而不是操心与网站的部署。</p>
<p>现在我们在 Github 和 Gitee 上各拥有一个 blog 仓库，而我们的自动部署方案将在 Github 上进行，借助于 Github Action 我们能够优雅的实现两个仓库的自动同步更新。</p>
<h4 id="初识GithubAction"><a href="#初识GithubAction" class="headerlink" title="初识GithubAction"></a>初识GithubAction</h4><p><a target="_blank" rel="noopener" href="https://github.com/features/actions">GitHub Actions</a> 是 GitHub 的<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html">持续集成服务</a>，于2018年10月推出。</p>
<blockquote>
<h1 id="Automate-your-workflow-from-idea-to-production"><a href="#Automate-your-workflow-from-idea-to-production" class="headerlink" title="Automate your workflow from idea to production"></a>Automate your workflow from idea to production</h1><p>GitHub Actions makes it easy to automate all your software workflows, now with world-class CI/CD. Build, test, and deploy your code right from GitHub. Make code reviews, branch management, and issue triaging work the way you want.</p>
</blockquote>
<p>关于 Github Action 的初步入门教程可以参考 <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">阮一峰 GitHub Actions 入门教程</a> ，其中也大致介绍了什么是 Github Action 。</p>
<p>如果你对 Github Action 感兴趣，希望深入了解其语法结构可以自行查阅 <a target="_blank" rel="noopener" href="https://docs.github.com/cn/actions">官方文档</a></p>
<h4 id="编写workflows文件"><a href="#编写workflows文件" class="headerlink" title="编写workflows文件"></a>编写workflows文件</h4><p>要想使用 Github Action 我们得在项目根目录下创建  <code>.github/workflows/main.yml</code> 。</p>
<p>GitHub 只要发现<code>.github/workflows</code>目录里面有<code>.yml</code>文件，就会自动运行该文件。</p>
<p><code>.github/workflows/main.yml</code>：</p>
<p>::: details</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">GitHub</span> <span class="string">Pages</span> <span class="string">And</span> <span class="string">Gitee</span> <span class="string">Pages</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># 构建并部署</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># 拉取仓库代码</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2.3.1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 构建</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="comment"># 注意在 Settings-&gt;Secrets 配置 VSSUE_CLIENT_ID : OAuth Apps</span></span><br><span class="line">          <span class="attr">VSSUEID:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.VSSUE_CLIENT_ID</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">VSSUESECRET:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.VSSUE_CLIENT_SECRET</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">&amp;&amp;</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 部署到分支</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@3.5.9</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># 注意在 Settings-&gt;Secrets 配置 ACCESS_TOKEN : Personal access tokens</span></span><br><span class="line">          <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># 需要部署的分支</span></span><br><span class="line">          <span class="attr">BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">          <span class="comment"># vue项目 build 目录</span></span><br><span class="line">          <span class="attr">FOLDER:</span> <span class="string">.vuepress/dist</span></span><br><span class="line">          </span><br><span class="line">  <span class="comment"># 同步 gitee 并 更新 giteepages</span></span><br><span class="line">  <span class="attr">sync-to-gitee:</span></span><br><span class="line">    <span class="attr">needs:</span> <span class="string">build-and-deploy</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># 克隆项目至 gitee</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Sync</span> <span class="string">to</span> <span class="string">Gitee</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">wearerequired/git-mirror-action@v1.0.1</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">            <span class="comment"># 注意在 Settings-&gt;Secrets 配置 GITEE_RSA_PRIVATE_KEY : id_rsa</span></span><br><span class="line">            <span class="comment"># 个人设置 -&gt; SSH公钥 -&gt; 上传公钥</span></span><br><span class="line">            <span class="attr">SSH_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_RSA_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 GitHub 源仓库地址 SSH</span></span><br><span class="line">            <span class="attr">source-repo:</span> <span class="string">&quot;git@github.com:QiJieH/blog.git&quot;</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 目标仓库地址</span></span><br><span class="line">            <span class="attr">destination-repo:</span> <span class="string">&quot;git@gitee.com:qijieh/blog.git&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 更新部署 gitee pages</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Gitee</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">yanglbme/gitee-pages-action@v1.1.3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 用户名</span></span><br><span class="line">            <span class="attr">gitee-username:</span> <span class="string">QiJieH</span></span><br><span class="line">            <span class="comment"># 注意在 Settings-&gt;Secrets 配置 GITEE_PASSWORD : gitee password</span></span><br><span class="line">            <span class="attr">gitee-password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 仓库</span></span><br><span class="line">            <span class="attr">gitee-repo:</span> <span class="string">qijieh/blog</span></span><br><span class="line">            <span class="comment"># 构建分支</span></span><br><span class="line">            <span class="attr">branch:</span> <span class="string">gh-pages</span></span><br></pre></td></tr></table></figure>

<p>:::</p>
<p>::: warning</p>
<p>注意 YAML 语法对于Tab缩进有着严格要求，请务必确保代码缩进格式正确！！！</p>
<p>:::</p>
<p>以上是本博客的 workflows 流程，如果你熟悉 Github 和 Gitee 的相关配置你可以直接套用并替换相关属性即可。当然，我也会在下方逐一带领配置。</p>
<p>首先确保你的 <code>main.yml</code> 文件路径正确，此时你的项目结构应该大致为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="selector-class">.github</span></span><br><span class="line">│   └── <span class="selector-tag">workflows</span></span><br><span class="line">│		└── <span class="selector-tag">main</span><span class="selector-class">.yml</span></span><br><span class="line">├── <span class="selector-class">.vuepress</span></span><br><span class="line">├── <span class="selector-tag">blogs</span></span><br><span class="line">├── <span class="selector-tag">node_modules</span></span><br><span class="line">├── <span class="selector-class">.gitignore</span></span><br><span class="line">├── <span class="selector-tag">package</span><span class="selector-class">.json</span></span><br><span class="line">├── <span class="selector-tag">package-lock</span><span class="selector-class">.json</span></span><br><span class="line">└── <span class="selector-tag">README</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>关于 <code>.gitignore</code> 文件说明：</p>
<p>由于现在方案的编译环节 <code>npm run build</code> 交由了 Github Action 完成，我们不再需要上传生成的静态文件目录</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_modules/</span><br><span class="line">.vuepress<span class="regexp">/dist/</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>接下来将会对 <code>.github/workflows/main.yml</code> 代码进行逐一讲解配置。</p>
<h4 id="基本字段说明"><a href="#基本字段说明" class="headerlink" title="基本字段说明"></a>基本字段说明</h4><p><strong>1. <code>name</code></strong></p>
<p><code>name </code> 字段是 workflow 的名称。如果省略该字段，默认为当前 workflow 的文件名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name: Deploy GitHub Pages And Gitee Pages</span><br></pre></td></tr></table></figure>

<p><strong>2. <code>on</code></strong></p>
<p><code>on </code> 字段指定触发 workflow 的条件，通常是某些事件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - master</span><br></pre></td></tr></table></figure>

<p>当推送至 <code>master</code> 分支时，触发 workflow。</p>
<p><strong>3. <code>jobs</code></strong></p>
<p><code>jobs</code> 字段是 workflow 的主体当满足 <code>on</code> 的条件时就会运行 <code>jobs</code> 中的各项任务</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">  <span class="attr">sync-to-gitee:</span></span><br></pre></td></tr></table></figure>

<p><strong>4. <code>needs</code></strong></p>
<p><code>needs</code> 字段当前 <code>job</code> 的依赖关系，只有当 <code>needs</code> 中的 <code>job</code> 运行完成后才会执行当前 <code>job</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">  <span class="attr">sync-to-gitee:</span></span><br><span class="line">  	<span class="attr">needs:</span> <span class="string">build-and-deploy</span></span><br></pre></td></tr></table></figure>

<p>其可以是一个 <code>job</code> 数组 <code>[job1,job2]</code></p>
<p><strong>5. <code>runs-on</code></strong></p>
<p>当前 <code>job</code> 运行的虚拟机环境，必填字段</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br></pre></td></tr></table></figure>

<p>可用虚拟机如下</p>
<ul>
<li><code>ubuntu-latest</code>，<code>ubuntu-18.04 </code> 或 <code>ubuntu-16.04</code></li>
<li><code>windows-latest</code>，<code>windows-2019 </code>  或 <code>windows-2016</code></li>
<li><code>macOS-latest</code> 或 <code>macOS-10.14</code></li>
</ul>
<p><strong>6.<code>steps</code></strong></p>
<p><code>steps</code>字段指定每个 <code>Job</code> 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。</p>
<blockquote>
<ul>
<li><code>name</code>：步骤名称。</li>
<li><code>use</code> ：使用市场发布的 action 脚本</li>
<li><code>run</code>：该步骤运行的命令或者 action。</li>
<li><code>env</code>：该步骤所需的环境变量。</li>
<li><code>with</code> ：额外配置信息</li>
</ul>
</blockquote>
<p>将 action 抽离出来，并设立市场复用代码正是 Github Action 的优越之处，在 <a target="_blank" rel="noopener" href="https://github.com/marketplace?type=actions">Markplace</a> 中发布了大量的 action 脚本，你可以直接在 yml 文件中以代码仓库的方式引用。</p>
<h4 id="工作流程梳理"><a href="#工作流程梳理" class="headerlink" title="工作流程梳理"></a>工作流程梳理</h4><p><code>main.yml</code>  的工作流程可以总结为：</p>
<ol>
<li>每当代码 push 到 master分支 时触发 wrokflow ，其一共有两个 <code>job</code></li>
<li>执行 <code>build-and-deploy</code> 任务，其分为三步 <code>step</code><ol>
<li><code>Checkout</code> ：使用了 <a target="_blank" rel="noopener" href="https://github.com/marketplace/actions/checkout">actions/checkout</a> 拉取代码到虚拟机</li>
<li><code>build</code> ：在虚拟机运行命令行 <code>npm install &amp;&amp; npm run build</code>  <strong>就是在这一步服务器帮我们编译生成了网页数据</strong></li>
<li><code>Deploy</code> ：使用 <a target="_blank" rel="noopener" href="https://github.com/marketplace/actions/deploy-to-github-pages">JamesIves/github-pages-deploy-action</a> 将生成的网页源码部署到 <code>gh-pages</code> 分支上</li>
</ol>
</li>
<li>当 <code>build-and-deploy</code> 执行完毕后，运行 <code>sync-to-gitee</code> 任务，其一共有两步 <code>step</code> <ol>
<li><code>Sync to Gitee</code> ：使用 <a target="_blank" rel="noopener" href="https://github.com/wearerequired/git-mirror-action">wearerequired/git-mirror-action</a> 强制同步 Gitee 仓库</li>
<li><code>Build Gitee Pages</code> ：使用 <a target="_blank" rel="noopener" href="https://github.com/yanglbme/gitee-pages-action">yanglbme/gitee-pages-action</a> 更新 Gitee Pages 服务，设置 <code>gh-pages</code> 分支的根目录为渲染目录</li>
</ol>
</li>
</ol>
<p>::: warning</p>
<p>注意：在自动部署方案中，我们不再使用单分支开发，我们将额外创建一个独立分支 <code>gh-pages</code> 用来托管生成的网页源码。</p>
<p>我们的项目分支结构应该为：</p>
<ul>
<li><code>master</code> ：存储 vuepress 构建代码</li>
<li><code>gh-pages</code> ：存储编译生成的网页源码</li>
</ul>
<p>该分支必须命名为 <code>gh-pages</code> ，否则无法使用 Github Pages 服务，你无需手动创建，<code>JamesIves/github-pages-deploy-action</code> 会自动帮我们创建该分支。</p>
<p>:::</p>
<h4 id="workflow敏感数据"><a href="#workflow敏感数据" class="headerlink" title="workflow敏感数据"></a>workflow敏感数据</h4><p>在某些 <code>step</code> 中，访问仓库，操作仓库等等一系列操作，会需要进行身份验证，这样就涉及到一些仓库令牌，访问密码之类的敏感数值，我们不能直接将其明文暴露在 <code>yml</code> 文件中，所以我们使用了系统环境变量的方式存储在了你的仓库（虚拟机）中，通过<br>::: v-pre<br><code>$&#123;&#123; secret.NAME &#125;&#125;</code><br>:::<br>方法，能让我们从虚拟机中拿到这些数值。</p>
<p>接下来我们将逐个生成和设置这些敏感数据</p>
<h5 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a><strong><code>Deploy</code></strong></h5><hr>
<p>在这一步中虚拟机会将  <code>FOLDER</code> 下的生成内容推送至 Github 仓库的 <code>gh-pages</code> 分支，所以需要一个仓库的访问令牌，你可以参考 <a target="_blank" rel="noopener" href="https://docs.github.com/cn/github/authenticating-to-github/creating-a-personal-access-token">官方文档 创建个人访问令牌</a> ，生成一个用于命令行访问仓库的个人令牌。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 部署到分支</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@3.5.9</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">    <span class="comment"># 注意在 Settings-&gt;Secrets 配置 ACCESS_TOKEN : Personal access tokens</span></span><br><span class="line">    <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="comment"># 需要部署的分支</span></span><br><span class="line">    <span class="attr">BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">    <span class="comment"># vue项目 build 目录</span></span><br><span class="line">    <span class="attr">FOLDER:</span> <span class="string">.vuepress/dist</span></span><br></pre></td></tr></table></figure>





<p><strong>个人头像 &gt; Setting &gt; Developer settings &gt; <a target="_blank" rel="noopener" href="https://github.com/settings/tokens">Personal access tokens</a> &gt; Generate new token</strong></p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806154720.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806154720.png</a> =780x)</p>
<p><code>Note</code> 仅用于提示令牌信息，**需要注意勾选 <code>Scopes</code> 中的 <code>repo</code> 和 <code>workflow</code>**，点击 <code>Generate token</code> 按钮生成 <code>token</code></p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806155101.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806155101.png</a> =780x)</p>
<p>之后页面会跳转会 <code>Personal access token</code> ，并出现蓝色提示框，里面的字符串便是生成的个人令牌，这串数值只会显示这一次，当你离开当前页面后就会被永久隐藏，请务必保管好。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806155442.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806155442.png</a> =780x)</p>
<p>虽然你可以将其直接复制到 <code>.giyhub/workflowes/main.yml</code> 文件的 <code>Deploy.with.ACCESS_TOKEN</code> ，但是这样是十分不安全的。<strong>接下来我们将其保存至仓库的 Secrets 下。</strong></p>
<blockquote>
<p>Secrets are environment variables that are <strong>encrypted</strong> and only exposed to selected actions. Anyone with <strong>collaborator</strong> access to this repository can use these secrets in a workflow.</p>
</blockquote>
<p>Secrets 相当于当前虚拟机的系统环境变量，在该仓库运行的 workflow 文件可以通过<br>::: v-pre<br><code>$&#123;&#123;secrets.NAME&#125;&#125;</code><br>:::<br>访问这些系统变量。</p>
<p><strong>仓库 &gt; Setting &gt; Secrets &gt; New Secrets</strong> 按照以下方式填写</p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806160224.png"></p>
<p>Name 是存储系统环境变量的名称，你可以随意填写只需修改 workflow 文件中的变量名即可。点击 Add secret 即可完成仓库系统环境的添加，只后只要在 workflow 文件中以<br>::: v-pre<br><code>$&#123;&#123; secrets.ACCESS_TOKEN &#125;&#125;</code><br>:::<br>的方式即可访问预先设置好的环境变量。</p>
<figure class="highlight yaml"><figcaption><span>&#123;5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@3.5.9</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># 注意在 Settings-&gt;Secrets 配置 ACCESS_TOKEN : Personal access tokens</span></span><br><span class="line">          <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># 需要部署的分支</span></span><br><span class="line">          <span class="attr">BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">          <span class="comment"># vue项目 build 目录</span></span><br><span class="line">          <span class="attr">FOLDER:</span> <span class="string">.vuepress/dist</span></span><br></pre></td></tr></table></figure>







<h5 id="Sync-to-Gitee"><a href="#Sync-to-Gitee" class="headerlink" title="Sync to Gitee"></a><strong><code>Sync to Gitee</code></strong></h5><hr>
<p>在这一步中 action 会完成 Gitee 仓库代码的同步，这里将会使用 <a target="_blank" rel="noopener" href="https://docs.github.com/cn/github/authenticating-to-github/connecting-to-github-with-ssh">SSH公私钥配对</a> 的方式进行 Gitee 身份验证。如果你熟悉 Github SSH 的配布方式可以自行设置。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 克隆项目至 gitee</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Sync</span> <span class="string">to</span> <span class="string">Gitee</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">wearerequired/git-mirror-action@v1.0.1</span></span><br><span class="line">  <span class="attr">env:</span></span><br><span class="line">      <span class="comment"># 注意在 Settings-&gt;Secrets 配置 GITEE_RSA_PRIVATE_KEY : id_rsa</span></span><br><span class="line">      <span class="comment"># 个人设置 -&gt; SSH公钥 -&gt; 上传公钥</span></span><br><span class="line">      <span class="attr">SSH_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_RSA_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">      <span class="comment"># 注意替换为你的 GitHub 源仓库地址 SSH</span></span><br><span class="line">      <span class="attr">source-repo:</span> <span class="string">&quot;git@github.com:QiJieH/blog.git&quot;</span></span><br><span class="line">      <span class="comment"># 注意替换为你的 Gitee 目标仓库地址</span></span><br><span class="line">      <span class="attr">destination-repo:</span> <span class="string">&quot;git@gitee.com:qijieh/blog.git&quot;</span></span><br></pre></td></tr></table></figure>



<p><strong>生成新 SSH 密钥</strong></p>
<blockquote>
<p>如果你计算机中曾经设置过 Github 或 Gitee 的 SSH 服务可以跳过此步。</p>
</blockquote>
<ol>
<li><p>打开 Git Bash。</p>
</li>
<li><p>键入以下命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure>
</li>
<li><p>提示您“Enter a file in which to save the key（输入要保存密钥的文件）”时，按 Enter 键。 这将接受默认文件位置。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> Enter a file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/c/Users/you/.ssh/id_rsa):[Press enter]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在提示时输入安全密码。 更多信息请参阅<a target="_blank" rel="noopener" href="https://docs.github.com/cn/articles/working-with-ssh-key-passphrases">“使用 SSH 密钥密码”</a>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> Enter passphrase (empty <span class="keyword">for</span> no passphrase): [Type a passphrase]</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Enter same passphrase again: [Type passphrase again]</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<p>运行上面步骤后在你的 <code>/c/Users/you/.ssh/</code> 目录下会拥有两个文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/c/</span>Users<span class="regexp">/you/</span>.ssh/</span><br><span class="line">	&gt; id_rsa    	<span class="regexp">//</span> 私钥存储在客户端</span><br><span class="line">	&gt; id_rsa_pub	<span class="regexp">//</span> 公钥存储在服务端</span><br></pre></td></tr></table></figure>

<p>你可以通过文本方式打开文件进行查看，接下来只需要将 <code>id_rsa_pub</code> 上传至远程仓库即可。</p>
<blockquote>
<p>这里参考的是 Github 的中文文档（文档比 Gitee 详细），SSH 公私钥生成是 Git 提供的服务，文档通用 。</p>
<p>Github 和 Gitee 都是基于 SSH 协议的 Git 服务，如果你在 Github 已经配置了 SSH ，你完全可以使用同一份公钥在 Gitee ，这样我们只使用一个私钥在两个平台都能进行验证。这里只需要在 Gitee 设置 SSH 。</p>
</blockquote>
<p><strong><a target="_blank" rel="noopener" href="https://gitee.com/help/articles/4191">Gitee SSH 公钥设置</a></strong></p>
<blockquote>
<p>注意此处我们需要生成的是 账户SSH Key 不是 仓库SSH Key，其区别如下：</p>
<p>和仓库”只读”权限的 SSH Key 相比，账户的 SSH Key <strong>同时具备<code>推送/拉取</code>的权限，对用户创建/参与的仓库均能使用</strong>，使用起来更加方便。</p>
</blockquote>
<p>主页右上角 <strong>「个人设置」-&gt;「安全设置」-&gt;「SSH公钥」-&gt;「<a target="_blank" rel="noopener" href="https://gitee.com/profile/sshkeys">添加公钥</a>」</strong> ，添加生成的 public key 添加到当前账户中。</p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806164348.png"></p>
<p>点击确定即可，可以不用管 SHA256 。</p>
<p>接下来，只需要将配套的将我们的 私钥<code>id_rsa</code> 储存在 Github 仓库的 Secrects 中，这样 workflow文件就能通过读取系统环境变量<br>::: v-pre<br><code>$&#123;&#123;secrect.Name&#125;&#125;</code><br>:::<br>的方式用私钥与 Gitee 上的公钥进行配对，以此验证身份，获得仓库操作权限。</p>
<p><strong>Github 仓库 &gt; Setting &gt; Secrets &gt; New Secrets</strong></p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806174117.png"></p>
<p>通过<br>::: v-pre<br><code>$&#123;&#123; secrtes.GITEE_RSA_PRIVATE_KEY &#125;&#125;</code><br>:::<br>与 Gitee 仓库进行 SSH 验证，获得 Gitee 仓库的操作权限。</p>
<figure class="highlight yaml"><figcaption><span>&#123;5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 克隆项目至 gitee</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Sync</span> <span class="string">to</span> <span class="string">Gitee</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">wearerequired/git-mirror-action@v1.0.1</span></span><br><span class="line">  <span class="attr">env:</span></span><br><span class="line">      <span class="attr">SSH_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_RSA_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">      <span class="comment"># 注意替换为你的 GitHub 源仓库地址SSH Clone</span></span><br><span class="line">      <span class="attr">source-repo:</span> <span class="string">&quot;git@github.com:QiJieH/blog.git&quot;</span></span><br><span class="line">      <span class="comment"># 注意替换为你的 Gitee 目标仓库地址 Sync</span></span><br><span class="line">      <span class="attr">destination-repo:</span> <span class="string">&quot;git@gitee.com:qijieh/blog.git&quot;</span></span><br></pre></td></tr></table></figure>





<h5 id="Build-Gitee-Pages"><a href="#Build-Gitee-Pages" class="headerlink" title="Build Gitee Pages"></a><strong><code>Build Gitee Pages</code></strong></h5><hr>
<p>完成代码的同步后，我们需要更新 Gitee Pages 服务，刷新网页内容。</p>
<blockquote>
<p>Gitee Pages 服务不支持自动更新，开通会员的 Gitee Pages Pro 服务将支持。</p>
<p>该 yanglbme/gitee-pages-action 的 Action 应该是使用了类似网页脚本的方法替代了手动点击 Gitee Pages 的更新按钮。</p>
<p>注意：该 action 需要事先开启 Gitee 仓库的 Pages 服务才能正常运行。但是此时我们的 Gitee 仓库还是为空，无法启动 Gitee Pages 服务，所以你需要在第一次推送后手动前往 Gitee Pages 开启。</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新部署 gitee pages</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Gitee</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">yanglbme/gitee-pages-action@v1.1.3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 用户名</span></span><br><span class="line">            <span class="attr">gitee-username:</span> <span class="string">QiJieH</span></span><br><span class="line">            <span class="comment"># 注意在 Settings-&gt;Secrets 配置 GITEE_PASSWORD : gitee password</span></span><br><span class="line">            <span class="attr">gitee-password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 仓库</span></span><br><span class="line">            <span class="attr">gitee-repo:</span> <span class="string">qijieh/blog</span></span><br><span class="line">            <span class="comment"># 构建分支</span></span><br><span class="line">            <span class="attr">branch:</span> <span class="string">gh-pages</span></span><br></pre></td></tr></table></figure>



<p>这个 action 需要我们提供 Gitee 的账户密码，我们依旧将其存放在 Github 仓库的 Secrtes 中。</p>
<p><strong>Github 仓库 &gt; Setting &gt; Secrets &gt; New Secrets</strong></p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806175611.png"></p>
<p>点击 Add secret ，这样 workflow 文件便可以提供系统环境变量的方式<br>::: v-pre<br><code>$&#123;&#123; GITEE_PASSWORD &#125;&#125;</code><br>:::<br>访问到我们的 Gitee 账户密码。</p>
<figure class="highlight yaml"><figcaption><span>&#123;8&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新部署 gitee pages</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Gitee</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">yanglbme/gitee-pages-action@v1.1.3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 用户名</span></span><br><span class="line">            <span class="attr">gitee-username:</span> <span class="string">QiJieH</span></span><br><span class="line">            <span class="comment"># 注意在 Settings-&gt;Secrets 配置 GITEE_PASSWORD : gitee password</span></span><br><span class="line">            <span class="attr">gitee-password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITEE_PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">            <span class="comment"># 注意替换为你的 Gitee 仓库</span></span><br><span class="line">            <span class="attr">gitee-repo:</span> <span class="string">qijieh/blog</span></span><br><span class="line">            <span class="comment"># 构建分支</span></span><br><span class="line">            <span class="attr">branch:</span> <span class="string">gh-pages</span></span><br></pre></td></tr></table></figure>





<h4 id="Vssue评论插件"><a href="#Vssue评论插件" class="headerlink" title="Vssue评论插件"></a>Vssue评论插件</h4><hr>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806184726.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806184726.png</a> =700x)</p>
<p><a target="_blank" rel="noopener" href="https://vssue.js.org/zh/guide/">Vssue</a> 是一款无需后台的评论系统，其由 Vue 驱动并基于 Github 仓库的 Issue 实现。被广泛运用于博客，文档等无后端评论场景。</p>
<p>由于其配置需要 Github 仓库的 Issue 所以需要通过 <a target="_blank" rel="noopener" href="https://github.com/settings/developers">Github OAuth Apps</a> 的接口数据。</p>
<p>由于 reco 主题已经将 Vssue 集合在了官方插件 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/plugins/comments.html">comment</a> 中，我们无需额外 <code>npm install</code>  ，通过参考 <a target="_blank" rel="noopener" href="https://vuepress-theme-reco.recoluan.com/views/plugins/comments.html">文档</a> 在项目的 <code>.vuepress/config.js</code> 中引入插件</p>
<figure class="highlight javascript"><figcaption><span>&#123;13,14&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  theme: <span class="string">&#x27;reco&#x27;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;@vuepress-reco/comments&#x27;</span>, </span><br><span class="line">        &#123;</span><br><span class="line">    		solution: <span class="string">&#x27;vssue&#x27;</span>,</span><br><span class="line">    		options: &#123;</span><br><span class="line">      			platform: <span class="string">&#x27;github&#x27;</span>,</span><br><span class="line">      			owner: <span class="string">&#x27;OWNER_OF_REPO&#x27;</span>,</span><br><span class="line">      			repo: <span class="string">&#x27;NAME_OF_REPO&#x27;</span>,</span><br><span class="line">      			clientId: <span class="string">&#x27;YOUR_CLIENT_ID&#x27;</span>,</span><br><span class="line">      			clientSecret: <span class="string">&#x27;YOUR_CLIENT_SECRET&#x27;</span>,</span><br><span class="line">    		&#125;</span><br><span class="line">  		&#125;</span><br><span class="line">    ],</span><br><span class="line">  ] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>其中的 <code>owner</code> 填写仓库拥有者，<code>repo</code> 填写仓库名称，<code>clientId</code> 和 <code>clientSecret</code> 需要前往 Github 仓库设置。</p>
<blockquote>
<p>我个人仓库的地址是 <a target="_blank" rel="noopener" href="https://github.com/QiJieH/blog">https://github.com/QiJieH/blog</a> 配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">owner: <span class="string">&#x27;QiJieH&#x27;</span>,</span><br><span class="line">repo: <span class="string">&#x27;blog&#x27;</span>,</span><br></pre></td></tr></table></figure>
</blockquote>
<p>依次点击 Github 的 <strong>个人头像 &gt; Setting &gt; Developer setting &gt; <a target="_blank" rel="noopener" href="https://github.com/settings/developers">OAuth Apps</a> &gt; New OAuth App</strong> </p>
<p><img src="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806185536.png"></p>
<p><code>Homepage URL</code> ：需要授权的网址</p>
<p><code>Authorization callback URL</code> ：授权回调地址</p>
<p>请自行修改该属性，填写完成后<strong>点击 Register application 提交</strong>。</p>
<p>只后我们在 OAuth Apps 列表便可以看见列表了，点击其进入</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806190302.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806190302.png</a> =700x)</p>
<p>其中的 <code>Client ID</code> 和 <code>Client Secret</code> 便是 Vssue 插件需要的配置值了。</p>
<p>将 <code>Client ID</code> 和 <code>Client Secret</code> 直接填写在 <code>config.js</code> 的 Vssue 插件配置中是不理智的，我们依旧可以使用 Github 仓库的 Secret 来存储这两个值，在 workflow 的编译 <code>build</code> 阶段将其以<br>::: v-pre<br><code>$&#123;&#123; secret.Name &#125;&#125;</code><br>:::<br>的方式访问其值。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806192128.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806192128.png</a> =700x)</p>
<p>这里不再详细说明设置方法，请自行参考之前几个 Secret 的配置教程。</p>
<p>添加成功后在我们的 workflow 文件中添加相应代码，<strong>将其添加进编译过程的环境中</strong></p>
<figure class="highlight yaml"><figcaption><span>&#123;5,6&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">  <span class="attr">env:</span></span><br><span class="line">    <span class="comment"># 注意在 Settings-&gt;Secrets 配置 VSSUE_CLIENT_ID : OAuth Apps</span></span><br><span class="line">    <span class="attr">VSSUEID:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.VSSUE_CLIENT_ID</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">VSSUESECRET:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.VSSUE_CLIENT_SECRET</span> <span class="string">&#125;&#125;</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">&amp;&amp;</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br></pre></td></tr></table></figure>



<p>这样在虚拟机运行时在环境中就拥有了 <code>VSSUEID</code> 和 <code>VSSUESECRET</code> 两个变量，而 node 为我们提供在一个 <code>process.env</code> 方法，让我们能够<strong>在编译的时候访问当前进程的环境变量</strong>，我们只需要在 <code>config.js</code> 的 Vssue 配置中使用该方法即可</p>
<figure class="highlight javascript"><figcaption><span>&#123;13,14&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .vuepress/config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  theme: <span class="string">&#x27;reco&#x27;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;@vuepress-reco/comments&#x27;</span>, </span><br><span class="line">        &#123;</span><br><span class="line">    		solution: <span class="string">&#x27;vssue&#x27;</span>,</span><br><span class="line">    		options: &#123;</span><br><span class="line">      			platform: <span class="string">&#x27;github&#x27;</span>,</span><br><span class="line">      			owner: <span class="string">&#x27;QiJieH&#x27;</span>,</span><br><span class="line">      			repo: <span class="string">&#x27;blog&#x27;</span>,</span><br><span class="line">      			clientId: process.env.VSSUEID,</span><br><span class="line">      			clientSecret: process.env.VSSUESECRET,</span><br><span class="line">    		&#125;</span><br><span class="line">  		&#125;</span><br><span class="line">    ],</span><br><span class="line">  ] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="开始推送"><a href="#开始推送" class="headerlink" title="开始推送"></a>开始推送</h4><p>确保你已经替换 workflow 文件中的数据，并在 Github 和 Gitee 设置好了相应配置。检查你的 <code>main.yml</code> 文件是否正确存储在路径 <code>.github/workflows/</code> 下。</p>
<p>一切准备就绪后开始你的 Git 流程，并见证 Github Action 的强大。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;first deploy&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>



<p>推送完成后，打开 Github仓库的 Actions 按照图片依次点击进入 Action 运行日志</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194019.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194019.png</a> =700x)</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194126.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194126.png</a> =700x)</p>
<p>之后你便可以看见你的 workflow 文件正在被逐一执行。</p>
<blockquote>
<p>绿勾代表执行成功</p>
<p>黄色代表正在执行</p>
<p>红叉代表执行出错</p>
<p><strong>你可以在这里检查出错原因，请根据原因自行 debug ，这里列出几个常见的错误：</strong></p>
<ul>
<li><p>main.yml 语法错误，请检查Tab缩进</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195900.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195900.png</a> =600x)</p>
</li>
<li><p>仓库操作错误，令牌或密码配置不正确，请根据该步骤需要的数据检查</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806200032.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806200032.png</a> =600x)</p>
</li>
<li><p>部分 action 配置错误，以下错误是以为在 Deploy 中设置生成目录 <code>.vuepress/dist</code> ，却在 <code>config.js</code> 中设置 <code>dest</code> 为 <code>docs</code> ，导致虚拟机编译 <code>npm run build</code> 后没有生成文件在 <code>.vuepress/dist</code> 下，进而致使 Deploy 环节无法从 <code>.vuepress/dist</code> 目录拉取代码到 <code>gh-pages</code> 分支。</p>
<figure class="highlight yaml"><figcaption><span>&#123;10&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 部署到分支</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@3.5.9</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># 注意在 Settings-&gt;Secrets 配置 ACCESS_TOKEN : Personal access tokens</span></span><br><span class="line">          <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># 需要部署的分支</span></span><br><span class="line">          <span class="attr">BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">          <span class="comment"># vue项目 build 目录</span></span><br><span class="line">          <span class="attr">FOLDER:</span> <span class="string">.vuepress/dist</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><figcaption><span>&#123;2&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  dest: <span class="string">&quot;.vuepress/dist&quot;</span>,  <span class="comment">// 确保这个目录与 FOLDER 保存一致</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806200421.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806200421.png</a> =680x)</p>
</li>
</ul>
</blockquote>
<p>当所有的 Action 正常执行完成后，你可以查看 Github 仓库是否更新了 <code>gh-pages</code> 分支，其是否存储了网页源码。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194559.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194559.png</a> =700x)</p>
<p>再访问你的 Gitee 仓库查看其是否同步了代码和分支。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194734.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194734.png</a> =700x)</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194823.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806194823.png</a> =700x)</p>
<p>接下来你只需要手动配置一次两个仓库的 Pages 服务。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195000.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195000.png</a> =700x)</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195059.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806195059.png</a> =700x)</p>
<p>之后便无需操心，每次提交 Github Action 都会为你完成一系列的工作。</p>
<h4 id="访问你的博客"><a href="#访问你的博客" class="headerlink" title="访问你的博客"></a>访问你的博客</h4><p>至此所有的自动部署已经完成，现在你的博客提交流程为：</p>
<ol>
<li>书写博文，修改主题</li>
<li><code>git push</code></li>
</ol>
<p>Github Action 在你看不见的地方为了完成了一系列操作：</p>
<ol>
<li>从仓库拉取代码</li>
<li>编译代码，生成网页源码，并推送到 <code>gh-pages</code> 分支</li>
<li>同步 Gitee 代码</li>
<li>更新 Gitee Pages 服务</li>
</ol>
<p>现在，访问你的博客网站吧！</p>
<h2 id="图床搭建"><a href="#图床搭建" class="headerlink" title="图床搭建"></a>图床搭建</h2><p>尽管你可以在 Markdown 文件中使用相对路径对项目下的 <code>public</code> 文件夹的图片进行引用，但是这样做无疑增加了我们仓库的容量占用，特别是当网站中引用大量图片时，我们不可能全部将其存储在 <code>public</code> 文件夹下，这对网站性能和仓库容量都是一种极大的浪费。</p>
<p>对此我选择了 <code>PicGo + Gitee</code> 在线图床的解决方案。借助于第三方的在线图床服务，我们可以在 Markdown 文件中通过 src 的方式访问在线的图片。</p>
<p>下载 <a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/PicGo">PicGo</a> 软件至你的电脑，安装并打开。</p>
<p>在插件设置中搜索 gitee 并安装插件。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806202625.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806202625.png</a> =700x)</p>
<p>安装成功后，打开 <strong>图床设置 &gt; Gitee图床</strong></p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204132.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204132.png</a> =700x)</p>
<p><code>owner</code> ：仓库所有者</p>
<p><code>repo</code> ：仓库名称</p>
<p><code>token</code> ：个人令牌</p>
<p>访问 Gitee 创建图床仓库</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806203152.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806203152.png</a> =700x)</p>
<blockquote>
<p>注意勾选 使用Readme文件初始化这个仓库</p>
</blockquote>
<p>点击 个人头像 &gt; 设置 &gt; 私人令牌 &gt; 生成新令牌</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806203354.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806203354.png</a> =700x)</p>
<p><strong>点击提交之后，令牌token会出现，请复制妥善保存。将其填入 PicGo 图床设置 &gt; Gitee图床 &gt; token 栏中。</strong></p>
<p>以我的仓库为例：</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204018.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204018.png</a> =700x)</p>
<p>应该填写：</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806202758.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806202758.png</a> =700x)</p>
<p>之后保持 PicGo 后台运行，当你的剪切板有图片或图片URL时，使用快捷键 Crtl + Shift + P 快速上传图片至仓库，随后你的剪切板将会返回图片的引用代码。</p>
<p>![](<a target="_blank" rel="noopener" href="https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204417.png">https://gitee.com/QiJieH/blog-image-bed/raw/master//20200806204417.png</a> =700x)</p>
<p>在此处可以选择引用何种代码片段。</p>
<p>PicGo 除了支持 Gitee 外还支持其他图床，你可以自行百度配置。</p>
<blockquote>
<p>Gitee 单仓库容量 500M</p>
<p>Github 单仓库容量 1G</p>
<p>SM.MS 容量 5G ，但是上传有时间限制</p>
</blockquote>
<h2 id="SEO优化"><a href="#SEO优化" class="headerlink" title="SEO优化"></a>SEO优化</h2><p>todo…</p>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">本文最后更新于 <span id="date-expire-num"></span> 天前，文中所描述的信息可能已发生改变</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2020-11-25");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2020-08-03T16:00:00.000Z" itemprop="datePublished">2020-08-04</time>

    , 最后修改于&nbsp;<time datetime="2020-11-25T09:26:27.960Z" itemprop="dateModified">2020-11-25</time>

</p>
<p class="post-footer-info mb-0 pt-2">

<span class="post-categories-list mt-2">

<a class="post-categories-list-item" href='/blog/categories/FrontEnd/'>FrontEnd</a>

</span>



<span class="post-tags-list mt-2">

<a class="post-tags-list-item" href="/blog/tags/Git/" rel="tag">#&nbsp;Git</a>

<a class="post-tags-list-item" href="/blog/tags/Github/" rel="tag">#&nbsp;Github</a>

<a class="post-tags-list-item" href="/blog/tags/Github-Pages/" rel="tag">#&nbsp;Github Pages</a>

<a class="post-tags-list-item" href="/blog/tags/Github-Action/" rel="tag">#&nbsp;Github Action</a>

<a class="post-tags-list-item" href="/blog/tags/Vuepress/" rel="tag">#&nbsp;Vuepress</a>

<a class="post-tags-list-item" href="/blog/tags/Gitee/" rel="tag">#&nbsp;Gitee</a>

</span>


</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/blog/2020/08/07/BackEnd-2020-8-MongDB-nodejs-example/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">MongoDB Node.js使用实例</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                        <div class="card-footer post-comment">
                            <div id="vcomments"></div>

<script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = ''.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = '' === 'true';
    var verify = '' === 'true';
    new Valine({
        el: '#vcomments',
        notify: notify,
        verify: verify,
        appId: "pTzaoyKfCTw4zkLCI6m5SUz1-gzGzoHsz",
        appKey: "5aCoVNPllel3XXlnHpbJ3gtl",
        placeholder: "Just go go",
        meta: guest_info,
        pageSize:'10',
        avatar:'retro',
        lang:'zh-cn',
        guest_info: guest_info,
        visitor: true
    });
</script>

                        </div>
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="http://qijieh.gitee.io/blog">QiJieH の Link</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    Hosted on <a target="_blank" href="https://github.com/QiJieH/blog" rel="nofollow noopener noreferrer noopener">Github Pages</a>
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        

        
            <span id="http://qijieh.gitee.io/blog" class="leancloud-visitors" data-flag-title="QiJieH の Link">
    <span></span><!--
 --><span class="leancloud-visitors-count">0</span><!--
 --><span> Visitor |</span>
</span>

        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};

(function() {
    var copyrightNow = new Date().getFullYear();
    var copyrightContent = document.getElementById('copyright-year');
    var copyrightSince = 2019;
    if (copyrightSince === copyrightNow) {
        copyrightContent.textContent = copyrightNow;
    } else {
        copyrightContent.textContent = copyrightSince + ' - ' + copyrightNow;
    }
})();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/blog/lib/vanilla-lazyload/lazyload.min.js" async></script>



<!-- Comment -->

    
        
    


<!-- ### Custom Footer ### -->

    </body>

</html>